# thumb2original API å®ç°è®¡åˆ’

## ğŸ“‹ é¡¹ç›®ç›®æ ‡

å°† thumb2original æ”¹é€ ä¸ºæ”¯æŒ **CLI å’Œ API åŒæ¨¡å¼**çš„é¡¹ç›®ï¼š
- **CLI æ¨¡å¼**ï¼šä¿æŒåŸæœ‰åŠŸèƒ½ï¼Œç›´æ¥ä¸‹è½½å›¾ç‰‡åˆ°æœ¬åœ°
- **API æ¨¡å¼**ï¼šç±»ä¼¼ extract.picsï¼Œæä¾›å¼‚æ­¥æå– APIï¼Œè¿”å›å›¾ç‰‡å…ƒæ•°æ®

---

## ğŸ¯ æ ¸å¿ƒéœ€æ±‚

### 1. API åŠŸèƒ½
- âœ… åˆ›å»ºæå–ä»»åŠ¡
- âœ… æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€å’Œå›¾ç‰‡åˆ—è¡¨
- âœ… SSE å®æ—¶è¿›åº¦æ¨é€

### 2. æŠ€æœ¯é€‰å‹
- **è¿›åº¦æ¨é€**ï¼šServer-Sent Events (SSE)
- **Web æ¡†æ¶**ï¼šExpress
- **å­˜å‚¨æ–¹å¼**ï¼šå†…å­˜å­˜å‚¨ï¼ˆMemoryStorageï¼‰
- **çˆ¬è™«æ¨¡å¼**ï¼šå¤ç”¨ç°æœ‰é€»è¾‘ï¼Œä½¿ç”¨ `twoPhaseApi` æ¨¡å¼ï¼ˆä»…åˆ†æï¼Œä¸ä¸‹è½½ï¼‰

### 3. æ¶æ„åŸåˆ™
- âœ… CLI å’Œ API å…±äº«æ ¸å¿ƒçˆ¬è™«é€»è¾‘
- âœ… API æ¨¡å¼ä¸ä¸‹è½½å›¾ç‰‡ï¼Œåªè¿”å›å…ƒæ•°æ®
- âœ… è½»é‡çº§è®¾è®¡ï¼Œæ˜“äºéƒ¨ç½²

---

## ğŸ“ æ–‡ä»¶ç»“æ„è§„åˆ’

```
thumb2original/
â”œâ”€â”€ index.js                          # CLI æ¨¡å¼å…¥å£ï¼ˆä¿æŒä¸å˜ï¼‰
â”œâ”€â”€ server.js                         # API æœåŠ¡å™¨å…¥å£ï¼ˆæ–°å¢ï¼‰
â”‚
â”œâ”€â”€ server/                           # API æœåŠ¡å™¨æ¨¡å—ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ app.js                        # Express åº”ç”¨é…ç½®
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ extractions.js            # æå–ä»»åŠ¡è·¯ç”±
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ ExtractionService.js      # æå–æœåŠ¡ï¼ˆæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼‰
â”‚   â”œâ”€â”€ storage/
â”‚   â”‚   â””â”€â”€ MemoryStorage.js          # å†…å­˜å­˜å‚¨
â”‚   â””â”€â”€ sse/
â”‚       â””â”€â”€ SSEManager.js             # SSE ç®¡ç†å™¨
â”‚
â”œâ”€â”€ lib/                              # æ ¸å¿ƒçˆ¬è™«é€»è¾‘ï¼ˆç°æœ‰ï¼Œå¤ç”¨ï¼‰
â”‚   â”œâ”€â”€ browserLauncher.js
â”‚   â”œâ”€â”€ pageLoader.js
â”‚   â”œâ”€â”€ imageExtractor.js
â”‚   â”œâ”€â”€ imageModeProcessor.js
â”‚   â”œâ”€â”€ downloadQueue.js
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ utils/                            # å·¥å…·å‡½æ•°ï¼ˆç°æœ‰ï¼‰
â”œâ”€â”€ config/                           # é…ç½®æ–‡ä»¶ï¼ˆç°æœ‰ï¼‰
â””â”€â”€ tests/                            # æµ‹è¯•æ–‡ä»¶ï¼ˆç°æœ‰ï¼‰
```

---

## ğŸ”§ API è®¾è®¡

### ç«¯ç‚¹åˆ—è¡¨

| HTTP æ–¹æ³• | è·¯å¾„ | åŠŸèƒ½æè¿° |
|-----------|------|----------|
| POST | `/api/extractions` | åˆ›å»ºæå–ä»»åŠ¡ |
| GET | `/api/extractions/:id` | æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€å’Œå›¾ç‰‡åˆ—è¡¨ |
| GET | `/api/extractions/:id/stream` | SSE å®æ—¶è¿›åº¦æ¨é€ |
| GET | `/health` | å¥åº·æ£€æŸ¥ |

### æ•°æ®ç»“æ„

#### ä»»åŠ¡å¯¹è±¡ (Extraction)
```json
{
  "id": "1234567890-abc123",
  "url": "https://example.com",
  "hash": "sha1_hash",
  "status": "pending|running|done|failed",
  "message": null,
  "status_changed_at": "2025-11-16T15:03:55.000000Z",
  "trigger": "api|web",
  "options": {
    "mode": "advanced",
    "imageMode": "all|originals_only"
  },
  "images": null | [...],
  "images_count": 0,
  "user_id": null,
  "project_id": null,
  "created_at": "2025-11-16T15:03:55.000000Z",
  "updated_at": "2025-11-16T15:03:55.000000Z"
}
```

#### å›¾ç‰‡å¯¹è±¡ (Image)
```json
{
  "id": "uuid",
  "url": "https://...",
  "name": "filename",
  "basename": "filename.jpg",
  "size": 123456,
  "type": "jpeg|png|webp|...",
  "width": 1920,
  "height": 1080
}
```

#### SSE äº‹ä»¶æ ¼å¼
```javascript
// è¿æ¥å»ºç«‹
data: {"type":"connected","message":"SSE connection established"}

// è¿›åº¦æ›´æ–°
data: {"type":"progress","message":"Loading page...","progress":20}
data: {"type":"progress","message":"Scrolling down...","progress":40}
data: {"type":"progress","message":"Finding images...","progress":60}
data: {"type":"progress","message":"Analyzing images...","progress":80}

// å®Œæˆ
data: {"type":"complete","images_count":21,"status":"done"}

// é”™è¯¯
data: {"type":"error","message":"Error message"}
```

---

## ğŸ—ï¸ æ ¸å¿ƒæ¨¡å—è®¾è®¡

### 1. SSEManager (server/sse/SSEManager.js)
**èŒè´£**ï¼šç®¡ç† SSE è¿æ¥å’Œäº‹ä»¶æ¨é€

**æ ¸å¿ƒæ–¹æ³•**ï¼š
- `addConnection(taskId, res)` - æ·»åŠ  SSE è¿æ¥
- `removeConnection(taskId, res)` - ç§»é™¤è¿æ¥
- `sendProgress(taskId, message, progress)` - å‘é€è¿›åº¦
- `sendComplete(taskId, data)` - å‘é€å®Œæˆäº‹ä»¶
- `sendError(taskId, error)` - å‘é€é”™è¯¯äº‹ä»¶

**ç‰¹ç‚¹**ï¼š
- æ”¯æŒä¸€ä¸ªä»»åŠ¡å¤šä¸ªè®¢é˜…è€…
- è‡ªåŠ¨æ¸…ç†è¿‡æœŸè¿æ¥
- ç»Ÿä¸€çš„äº‹ä»¶æ ¼å¼

### 2. MemoryStorage (server/storage/MemoryStorage.js)
**èŒè´£**ï¼šå­˜å‚¨æå–ä»»åŠ¡æ•°æ®

**æ ¸å¿ƒæ–¹æ³•**ï¼š
- `create(taskData)` - åˆ›å»ºä»»åŠ¡
- `get(taskId)` - è·å–ä»»åŠ¡
- `update(taskId, updates)` - æ›´æ–°ä»»åŠ¡
- `cleanup(olderThanMs)` - æ¸…ç†æ—§ä»»åŠ¡
- `getStats()` - è·å–ç»Ÿè®¡ä¿¡æ¯

**ç‰¹ç‚¹**ï¼š
- ä½¿ç”¨ Map å­˜å‚¨
- è‡ªåŠ¨æ·»åŠ æ—¶é—´æˆ³
- æ”¯æŒæŒ‰çŠ¶æ€è¿‡æ»¤

### 3. ExtractionService (server/services/ExtractionService.js)
**èŒè´£**ï¼šå¤„ç†å›¾ç‰‡æå–ä»»åŠ¡çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘

**æ ¸å¿ƒæ–¹æ³•**ï¼š
- `createExtraction(url, options)` - åˆ›å»ºæå–ä»»åŠ¡
- `executeExtraction(taskId)` - æ‰§è¡Œæå–ä»»åŠ¡
- `formatImages(validEntries)` - æ ¼å¼åŒ–å›¾ç‰‡æ•°æ®

**å·¥ä½œæµç¨‹**ï¼š
```
1. åˆ›å»ºä»»åŠ¡ â†’ å­˜å‚¨åˆ° MemoryStorage
2. å¼‚æ­¥æ‰§è¡Œï¼š
   a. å¯åŠ¨æµè§ˆå™¨ (progress: 5-10%)
   b. åŠ è½½é¡µé¢ (progress: 20%)
   c. æ»šåŠ¨é¡µé¢ (progress: 40%)
   d. æŸ¥æ‰¾å›¾ç‰‡ (progress: 60%)
   e. åˆ†æå›¾ç‰‡ (progress: 80%, twoPhaseApi æ¨¡å¼)
   f. å®Œæˆ (progress: 100%)
3. æ›´æ–°ä»»åŠ¡çŠ¶æ€ â†’ æ¨é€ SSE äº‹ä»¶
```

**å…³é”®ç‚¹**ï¼š
- ä½¿ç”¨ `twoPhaseApi` æ¨¡å¼ï¼šåªåˆ†æå›¾ç‰‡å…ƒæ•°æ®ï¼Œä¸ä¸‹è½½
- å¤ç”¨ç°æœ‰çš„ `processDownloadQueue` å‡½æ•°
- é€šè¿‡ SSEManager å‘é€å®æ—¶è¿›åº¦

### 4. Routes (server/routes/extractions.js)
**èŒè´£**ï¼šå®šä¹‰ API è·¯ç”±

**è·¯ç”±å®šä¹‰**ï¼š
```javascript
POST   /api/extractions           â†’ åˆ›å»ºä»»åŠ¡
GET    /api/extractions/:id       â†’ æŸ¥è¯¢ä»»åŠ¡
GET    /api/extractions/:id/stream â†’ SSE æµ
```

### 5. Express App (server/app.js)
**èŒè´£**ï¼šé…ç½® Express åº”ç”¨

**ä¸­é—´ä»¶**ï¼š
- CORS
- JSON body parser
- é”™è¯¯å¤„ç†
- æ—¥å¿—è®°å½•

---

## ğŸ”„ æ•°æ®æµè®¾è®¡

### åˆ›å»ºæå–ä»»åŠ¡æµç¨‹
```
å®¢æˆ·ç«¯                  API æœåŠ¡å™¨                    çˆ¬è™«å¼•æ“
  â”‚                        â”‚                            â”‚
  â”œâ”€ POST /api/extractions â”€â†’â”‚                            â”‚
  â”‚                        â”‚                            â”‚
  â”‚                        â”œâ”€ ç”Ÿæˆä»»åŠ¡ ID                â”‚
  â”‚                        â”œâ”€ å­˜å‚¨åˆ° MemoryStorage       â”‚
  â”‚                        â”œâ”€ è¿”å›ä»»åŠ¡ä¿¡æ¯ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚â†â”€ {id, status:pending} â”€â”¤                            â”‚
  â”‚                        â”‚                            â”‚
  â”‚                        â”œâ”€ å¼‚æ­¥æ‰§è¡Œ â”€â†’ executeExtraction()
  â”‚                        â”‚                            â”‚
  â”‚                        â”‚                   å¯åŠ¨æµè§ˆå™¨ (5%)
  â”‚                        â”‚                   åŠ è½½é¡µé¢ (20%)
  â”‚                        â”‚                   æ»šåŠ¨é¡µé¢ (40%)
  â”‚                        â”‚                   æŸ¥æ‰¾å›¾ç‰‡ (60%)
  â”‚                        â”‚                   åˆ†æå›¾ç‰‡ (80%)
  â”‚                        â”‚                   å®Œæˆ (100%)
  â”‚                        â”‚                            â”‚
  â”‚                        â”œâ”€ æ›´æ–°ä»»åŠ¡çŠ¶æ€ä¸º done        â”‚
  â”‚                        â”‚                            â”‚
```

### SSE å®æ—¶è¿›åº¦æ¨é€æµç¨‹
```
å®¢æˆ·ç«¯                  API æœåŠ¡å™¨                SSEManager
  â”‚                        â”‚                        â”‚
  â”œâ”€ GET /stream/:id â”€â”€â”€â”€â”€â”€â†’â”‚                        â”‚
  â”‚                        â”œâ”€ æ·»åŠ è¿æ¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
  â”‚â†â”€ SSE: connected â”€â”€â”€â”€â”€â”€â”¤                        â”‚
  â”‚                        â”‚                        â”‚
  â”‚                     çˆ¬è™«æ‰§è¡Œä¸­...                â”‚
  â”‚                        â”‚                        â”‚
  â”‚                        â”‚â†â”€ sendProgress() â”€â”€â”€â”€â”€â”€â”¤
  â”‚â†â”€ SSE: progress 20% â”€â”€â”€â”¤                        â”‚
  â”‚                        â”‚                        â”‚
  â”‚                        â”‚â†â”€ sendProgress() â”€â”€â”€â”€â”€â”€â”¤
  â”‚â†â”€ SSE: progress 40% â”€â”€â”€â”¤                        â”‚
  â”‚                        â”‚                        â”‚
  â”‚                        â”‚â†â”€ sendComplete() â”€â”€â”€â”€â”€â”€â”¤
  â”‚â†â”€ SSE: complete â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
  â”‚                        â”œâ”€ å…³é—­è¿æ¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
  â”‚                        â”‚                        â”‚
```

### æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€æµç¨‹
```
å®¢æˆ·ç«¯                  API æœåŠ¡å™¨                MemoryStorage
  â”‚                        â”‚                        â”‚
  â”œâ”€ GET /api/extractions/:id â”€â†’â”‚                   â”‚
  â”‚                        â”œâ”€ æŸ¥è¯¢ä»»åŠ¡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
  â”‚                        â”‚â†â”€ è¿”å›ä»»åŠ¡æ•°æ® â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚â†â”€ {id, status, images} â”€â”¤                        â”‚
  â”‚                        â”‚                        â”‚
```

---

## ğŸ“ å®ç°æ­¥éª¤

### ç¬¬ä¸€é˜¶æ®µï¼šæ ¸å¿ƒæ¨¡å—ï¼ˆå·²å®Œæˆï¼‰
- [x] SSEManager.js - SSE è¿æ¥ç®¡ç†
- [x] MemoryStorage.js - å†…å­˜å­˜å‚¨
- [x] ExtractionService.js - æå–æœåŠ¡

### ç¬¬äºŒé˜¶æ®µï¼šAPI è·¯ç”±å’ŒæœåŠ¡å™¨
- [ ] server/routes/extractions.js - API è·¯ç”±å®šä¹‰
- [ ] server/app.js - Express åº”ç”¨é…ç½®
- [ ] server.js - æœåŠ¡å™¨å…¥å£æ–‡ä»¶

### ç¬¬ä¸‰é˜¶æ®µï¼šæµ‹è¯•å’Œç¤ºä¾‹
- [ ] åˆ›å»ºæµ‹è¯•è„šæœ¬
- [ ] åˆ›å»ºå‰ç«¯ç¤ºä¾‹ï¼ˆHTML + JavaScriptï¼‰
- [ ] API æ–‡æ¡£

### ç¬¬å››é˜¶æ®µï¼šä¼˜åŒ–å’Œå®Œå–„
- [ ] é”™è¯¯å¤„ç†å¢å¼º
- [ ] æ—¥å¿—ç³»ç»Ÿä¼˜åŒ–
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] éƒ¨ç½²æŒ‡å—

---

## ğŸ§ª æµ‹è¯•è®¡åˆ’

### å•å…ƒæµ‹è¯•
- [ ] SSEManager è¿æ¥ç®¡ç†æµ‹è¯•
- [ ] MemoryStorage CRUD æµ‹è¯•
- [ ] ExtractionService ä»»åŠ¡åˆ›å»ºå’Œæ‰§è¡Œæµ‹è¯•

### é›†æˆæµ‹è¯•
- [ ] å®Œæ•´æå–æµç¨‹æµ‹è¯•
- [ ] SSE äº‹ä»¶æ¨é€æµ‹è¯•
- [ ] å¹¶å‘ä»»åŠ¡æµ‹è¯•

### æ‰‹åŠ¨æµ‹è¯•
- [ ] ä½¿ç”¨ cURL æµ‹è¯• API
- [ ] ä½¿ç”¨æµè§ˆå™¨æµ‹è¯• SSE
- [ ] æµ‹è¯•å„ç§ç½‘ç«™çš„æå–

---

## ğŸ“¦ ä¾èµ–æ›´æ–°

**ç°æœ‰ä¾èµ–**ï¼ˆä¿æŒï¼‰ï¼š
- express
- cors
- puppeteer
- puppeteer-extra
- puppeteer-extra-plugin-stealth
- sharp
- image-size
- axios
- cheerio-without-node-native
- pino
- log-update

**ç§»é™¤ä¾èµ–**ï¼š
- socket.ioï¼ˆä¸éœ€è¦ WebSocketï¼‰

---

## ğŸš€ éƒ¨ç½²å’Œè¿è¡Œ

### å¼€å‘æ¨¡å¼
```bash
# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨ API æœåŠ¡å™¨
npm run server

# æˆ–ä½¿ç”¨å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰
npm run dev
```

### ç”Ÿäº§æ¨¡å¼
```bash
# ä½¿ç”¨ PM2
pm2 start server.js --name thumb2original-api

# æˆ–ä½¿ç”¨ Docker
docker build -t thumb2original .
docker run -d -p 3000:3000 thumb2original
```

### ç¯å¢ƒå˜é‡
```bash
PORT=3000              # API æœåŠ¡å™¨ç«¯å£
HOST=0.0.0.0           # ç»‘å®šåœ°å€
NODE_ENV=production    # ç¯å¢ƒæ¨¡å¼
```

---

## ğŸ“Š æ€§èƒ½è€ƒè™‘

### å¹¶å‘æ§åˆ¶
- ä½¿ç”¨å¼‚æ­¥ä»»åŠ¡å¤„ç†ï¼Œä¸é˜»å¡ API å“åº”
- é™åˆ¶åŒæ—¶è¿è¡Œçš„æµè§ˆå™¨å®ä¾‹æ•°é‡
- å®šæœŸæ¸…ç†å·²å®Œæˆçš„ä»»åŠ¡

### å†…å­˜ç®¡ç†
- å®šæœŸæ¸…ç† 1 å°æ—¶å‰çš„å·²å®Œæˆä»»åŠ¡
- å›¾ç‰‡åˆ†æä½¿ç”¨ twoPhaseApi æ¨¡å¼ï¼Œä¸å­˜å‚¨ Buffer
- SSE è¿æ¥è‡ªåŠ¨æ¸…ç†

### èµ„æºé™åˆ¶
```javascript
// å»ºè®®é…ç½®
{
  maxConcurrentTasks: 3,        // æœ€å¤§å¹¶å‘ä»»åŠ¡æ•°
  taskCleanupInterval: 600000,  // æ¸…ç†é—´éš”ï¼ˆ10åˆ†é’Ÿï¼‰
  taskMaxAge: 3600000,          // ä»»åŠ¡æœ€å¤§ä¿ç•™æ—¶é—´ï¼ˆ1å°æ—¶ï¼‰
  sseTimeout: 300000            // SSE è¿æ¥è¶…æ—¶ï¼ˆ5åˆ†é’Ÿï¼‰
}
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ä¸ CLI æ¨¡å¼çš„åŒºåˆ«
| ç‰¹æ€§ | CLI æ¨¡å¼ | API æ¨¡å¼ |
|------|----------|----------|
| ä¸‹è½½å›¾ç‰‡ | âœ… ç›´æ¥ä¸‹è½½åˆ°æœ¬åœ° | âŒ ä¸ä¸‹è½½ï¼Œä»…è¿”å›å…ƒæ•°æ® |
| é…ç½®æ¨¡å¼ | ä»»æ„æ¨¡å¼ | å¼ºåˆ¶ `twoPhaseApi` |
| è¾“å‡ºç»“æœ | æœ¬åœ°æ–‡ä»¶ | JSON å“åº” |
| è¿›åº¦æ˜¾ç¤º | æ§åˆ¶å°æ—¥å¿— | SSE äº‹ä»¶ |

### 2. twoPhaseApi æ¨¡å¼è¯´æ˜
- ä»…æ‰§è¡Œå›¾ç‰‡åˆ†æï¼Œè·å–å…ƒæ•°æ®ï¼ˆURLã€å°ºå¯¸ã€æ ¼å¼ï¼‰
- ä¸ä¸‹è½½å›¾ç‰‡åˆ°æœåŠ¡å™¨
- ä¸åˆ›å»ºä¸‹è½½ç›®å½•
- é€‚åˆ API æœåŠ¡ï¼Œå‡å°‘æœåŠ¡å™¨å­˜å‚¨å‹åŠ›

### 3. å®‰å…¨è€ƒè™‘
- æ·»åŠ è¯·æ±‚é¢‘ç‡é™åˆ¶
- éªŒè¯è¾“å…¥ URL æ ¼å¼
- è®¾ç½®æµè§ˆå™¨èµ„æºé™åˆ¶
- æ·»åŠ è¶…æ—¶æ§åˆ¶

---

## ğŸ“š æ–‡æ¡£è®¡åˆ’

### API æ–‡æ¡£
- [ ] API ç«¯ç‚¹è¯´æ˜
- [ ] è¯·æ±‚/å“åº”ç¤ºä¾‹
- [ ] é”™è¯¯ç è¯´æ˜
- [ ] SSE äº‹ä»¶æ ¼å¼

### ä½¿ç”¨æŒ‡å—
- [ ] å¿«é€Ÿå¼€å§‹
- [ ] å®Œæ•´ç¤ºä¾‹ï¼ˆcURLã€JavaScriptã€Pythonï¼‰
- [ ] å‰ç«¯é›†æˆæŒ‡å—
- [ ] éƒ¨ç½²æŒ‡å—

### å¼€å‘æ–‡æ¡£
- [ ] æ¶æ„è®¾è®¡è¯´æ˜
- [ ] ä»£ç ç»“æ„è¯´æ˜
- [ ] æ‰©å±•æŒ‡å—

---

## ğŸ¯ æˆåŠŸæ ‡å‡†

### åŠŸèƒ½å®Œæ•´æ€§
- âœ… åˆ›å»ºæå–ä»»åŠ¡å¹¶è¿”å›ä»»åŠ¡ ID
- âœ… å¼‚æ­¥æ‰§è¡Œçˆ¬å–å’Œåˆ†æ
- âœ… SSE å®æ—¶æ¨é€è¿›åº¦ï¼ˆ5ä¸ªé˜¶æ®µï¼‰
- âœ… æŸ¥è¯¢ä»»åŠ¡è¿”å›å®Œæ•´çš„å›¾ç‰‡åˆ—è¡¨
- âœ… æ”¯æŒç¼©ç•¥å›¾è½¬åŸå›¾ï¼ˆimageMode: originals_onlyï¼‰

### æ€§èƒ½æŒ‡æ ‡
- API å“åº”æ—¶é—´ < 200msï¼ˆåˆ›å»ºä»»åŠ¡ï¼‰
- SSE äº‹ä»¶å»¶è¿Ÿ < 100ms
- æ”¯æŒè‡³å°‘ 3 ä¸ªå¹¶å‘ä»»åŠ¡
- å•ä¸ªä»»åŠ¡å¤„ç†æ—¶é—´ä¸ CLI æ¨¡å¼ç›¸å½“

### ç¨³å®šæ€§
- é”™è¯¯å¤„ç†å®Œå–„ï¼Œä¸ä¼šå´©æºƒ
- è‡ªåŠ¨æ¸…ç†èµ„æºï¼ˆæµè§ˆå™¨ã€è¿æ¥ã€å†…å­˜ï¼‰
- æ”¯æŒé•¿æ—¶é—´è¿è¡Œ

---

## ğŸ”„ åç»­æ‰©å±•æ–¹å‘

### çŸ­æœŸï¼ˆv2.1ï¼‰
- [ ] æ·»åŠ ä»»åŠ¡å–æ¶ˆåŠŸèƒ½
- [ ] æ”¯æŒ Webhook é€šçŸ¥
- [ ] æ·»åŠ å›¾ç‰‡ä¸‹è½½ç«¯ç‚¹ï¼ˆå•ä¸ª/ZIPï¼‰

### ä¸­æœŸï¼ˆv2.2ï¼‰
- [ ] Redis æŒä¹…åŒ–å­˜å‚¨
- [ ] ä»»åŠ¡é˜Ÿåˆ—ï¼ˆBullMQï¼‰
- [ ] è®¤è¯å’Œæˆæƒ

### é•¿æœŸï¼ˆv3.0ï¼‰
- [ ] åˆ†å¸ƒå¼éƒ¨ç½²
- [ ] å›¾ç‰‡ CDN æ‰˜ç®¡
- [ ] ç®¡ç†åå°ç•Œé¢

---

## âœ… å®¡æ‰¹æ£€æŸ¥æ¸…å•

è¯·ç¡®è®¤ä»¥ä¸‹å†…å®¹ï¼š

- [ ] API è®¾è®¡ç¬¦åˆ extract.pics é£æ ¼
- [ ] ä½¿ç”¨ SSE è€Œä¸æ˜¯ WebSocket
- [ ] å¤ç”¨ç°æœ‰çˆ¬è™«é€»è¾‘ï¼Œä½¿ç”¨ twoPhaseApi æ¨¡å¼
- [ ] æ–‡ä»¶ç»“æ„æ¸…æ™°åˆç†
- [ ] æ•°æ®ç»“æ„ç¬¦åˆé¢„æœŸ
- [ ] å®ç°æ­¥éª¤å¯è¡Œ
- [ ] æ€§èƒ½å’Œå®‰å…¨è€ƒè™‘å……åˆ†

---

**è¯·å®¡é˜…æ­¤è®¡åˆ’ï¼Œç¡®è®¤åæˆ‘å°†å¼€å§‹å®æ–½ï¼**
